<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFT Service - Test Harness</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #0ff;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #f0f;
            text-shadow: 0 0 10px #f0f;
            margin-bottom: 30px;
        }
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #0ff;
            border-radius: 5px;
        }
        .test-section h2 {
            color: #0ff;
            margin-top: 0;
        }
        button {
            background: #333;
            color: #0ff;
            border: 1px solid #0ff;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-family: inherit;
        }
        button:hover {
            background: #0ff;
            color: #000;
        }
        #console-output {
            background: #000;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid #0ff;
            min-height: 200px;
            max-height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            font-size: 12px;
        }
        .warning {
            color: #ff0;
            background: #440;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ff0;
        }
    </style>
</head>
<body>
    <h1>üß™ NFT Service Test Harness</h1>
    
    <div class="warning">
        ‚ö†Ô∏è WARNING: This is a diagnostic tool. Do not use in production!<br>
        Open browser console for full output.
    </div>

    <div class="test-section">
        <h2>üì° Contract Connection Tests</h2>
        <button onclick="loadScript('js/diagnose-contract-failure.js')">Diagnose Contract Failures</button>
        <button onclick="loadScript('js/fix-tronweb-contract.js')">Fix TronWeb Contract</button>
        <button onclick="loadScript('js/contract-connection-fix.js')">Contract Connection Fix</button>
    </div>

    <div class="test-section">
        <h2>üîç Alert Verification</h2>
        <button onclick="loadScript('js/check-alert-27.js')">Check Alert #27</button>
        <button onclick="loadScript('js/fix-check-alert-27.js')">Fix Check Alert #27</button>
        <button onclick="loadScript('js/find-alert-27.js')">Find Alert #27</button>
        <button onclick="loadScript('js/check-last-alert.js')">Check Last Alert</button>
        <button onclick="loadScript('js/check-all-alerts-status.js')">Check All Alerts Status</button>
    </div>

    <div class="test-section">
        <h2>üìã Metadata Tests</h2>
        <button onclick="loadScript('js/check-metadata-structure.js')">Check Metadata Structure</button>
        <button onclick="loadScript('js/check-metadata-fields.js')">Check Metadata Fields</button>
        <button onclick="loadScript('js/debug-nft-metadata.js')">Debug NFT Metadata</button>
        <button onclick="loadScript('js/analyze-working-nfts.js')">Analyze Working NFTs</button>
    </div>

    <div class="test-section">
        <h2>üíº Wallet & Blockchain</h2>
        <button onclick="loadScript('js/check-wallet-nfts.js')">Check Wallet NFTs</button>
        <button onclick="loadScript('js/check-blockchain-transaction.js')">Check Blockchain Transaction</button>
        <button onclick="loadScript('js/investigate-alert-display.js')">Investigate Alert Display</button>
    </div>

    <div class="test-section">
        <h2>üßπ Cleanup & Test Data</h2>
        <button onclick="loadScript('js/cleanup-test-cases.js')">Cleanup Test Cases</button>
        <button onclick="loadScript('js/clear-test-data.js')">Clear Test Data</button>
    </div>

    <div class="test-section">
        <h2>üõ†Ô∏è Fixes & Monitoring</h2>
        <button onclick="loadScript('js/fix-energy-monitoring.js')">Fix Energy Monitoring</button>
        <button onclick="loadScript('js/fix-backend-access.js')">Fix Backend Access</button>
        <button onclick="loadScript('js/fix-dismiss-system.js')">Fix Dismiss System</button>
        <button onclick="loadScript('js/fix-metadata-fetch.js')">Fix Metadata Fetch</button>
    </div>

    <div class="test-section">
        <h2>üìä Test Suite</h2>
        <button onclick="loadScript('js/test-suite-overview.js')">Load Test Suite Overview</button>
        <button onclick="runQuickTest()">Run Quick Health Check</button>
    </div>

    <div id="console-output">
        Console output will appear here...
    </div>

    <script>
        // Capture console output
        const output = document.getElementById('console-output');
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            output.textContent += args.join(' ') + '\n';
            output.scrollTop = output.scrollHeight;
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            output.textContent += '‚ùå ' + args.join(' ') + '\n';
            output.scrollTop = output.scrollHeight;
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            output.textContent += '‚ö†Ô∏è ' + args.join(' ') + '\n';
            output.scrollTop = output.scrollHeight;
        };

        // Load script function
        function loadScript(src) {
            console.log(`Loading ${src}...`);
            const script = document.createElement('script');
            script.src = src;
            script.onload = () => console.log(`‚úÖ Loaded ${src}`);
            script.onerror = () => console.error(`Failed to load ${src}`);
            document.head.appendChild(script);
        }
        
        // Quick test function
        async function runQuickTest() {
            console.log('Running quick health check...\n');
            
            // Check TronWeb
            if (window.tronWeb) {
                console.log('‚úÖ TronWeb loaded');
                if (window.tronWeb.defaultAddress?.base58) {
                    console.log('‚úÖ Wallet connected:', window.tronWeb.defaultAddress.base58);
                } else {
                    console.log('‚ùå No wallet connected');
                }
            } else {
                console.log('‚ùå TronWeb not found');
            }
            
            // Check contracts
            try {
                const contract = await window.tronWeb.contract().at('TXHKwNNPVgPCABEsJQfKVKj5g6p4LN3Mcb');
                console.log('‚úÖ Contract connection working');
            } catch (e) {
                console.log('‚ùå Contract connection failed:', e.message);
            }
            
            console.log('\nHealth check complete!');
        }
        
        // Initial message
        console.log('Test harness ready! Click buttons to load diagnostic scripts.');
    </script>
</body>
</html>