<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Serve Test - Same Documents to Multiple Recipients</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: 'Arial', sans-serif; 
            background: linear-gradient(135deg, #1e3c72, #2a5298); 
            color: #fff; 
            padding: 20px;
            min-height: 100vh;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        
        h1 { 
            text-align: center; 
            margin-bottom: 30px;
            font-size: 2em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .panel {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .panel h2 {
            margin-bottom: 20px;
            color: #4FC3F7;
            font-size: 1.3em;
            border-bottom: 2px solid rgba(79,195,247,0.3);
            padding-bottom: 10px;
        }
        
        .document-item {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid #4FC3F7;
        }
        
        .document-item input[type="file"] {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border: 1px dashed rgba(255,255,255,0.3);
            border-radius: 5px;
            width: 100%;
            color: #fff;
        }
        
        .file-preview {
            background: rgba(76,175,80,0.2);
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-size: 0.9em;
        }
        
        .recipient-item {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .recipient-item input {
            flex: 1;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 5px;
            color: #fff;
            margin-right: 10px;
        }
        
        .recipient-item input::placeholder {
            color: rgba(255,255,255,0.5);
        }
        
        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 5px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102,126,234,0.4);
        }
        
        .add-btn {
            background: #4CAF50;
        }
        
        .remove-btn {
            background: #f44336;
            padding: 8px 12px;
            font-size: 0.9em;
        }
        
        .cost-breakdown {
            background: linear-gradient(135deg, rgba(255,193,7,0.1), rgba(255,152,0,0.1));
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .cost-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .cost-row:last-child {
            border-bottom: none;
            font-size: 1.2em;
            font-weight: bold;
            color: #FFD700;
            margin-top: 10px;
            padding-top: 15px;
            border-top: 2px solid #FFD700;
        }
        
        .scenario-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        
        .scenario-btn {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .scenario-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.05);
        }
        
        .log {
            background: #000;
            padding: 20px;
            border-radius: 10px;
            height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin-top: 20px;
        }
        
        .log-pass { color: #4CAF50; }
        .log-fail { color: #f44336; }
        .log-warn { color: #FFC107; }
        .log-info { color: #2196F3; }
        
        .summary-box {
            background: rgba(33,150,243,0.2);
            border: 2px solid #2196F3;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #4FC3F7;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: rgba(255,255,255,0.7);
            margin-top: 5px;
        }
        
        .comparison-table {
            width: 100%;
            margin: 20px 0;
            border-collapse: collapse;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .comparison-table th {
            background: rgba(0,0,0,0.3);
            color: #4FC3F7;
        }
        
        .highlight {
            background: rgba(76,175,80,0.2);
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚öñÔ∏è Multi-Serve Legal Notice Test</h1>
        <p style="text-align: center; margin-bottom: 30px; opacity: 0.9;">
            Serve the same legal documents to multiple recipients in a single transaction
        </p>
        
        <div class="summary-box">
            <h3>Current Scenario</h3>
            <div class="summary-stats">
                <div class="stat">
                    <div class="stat-value" id="doc-count">0</div>
                    <div class="stat-label">Documents</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="recipient-count">0</div>
                    <div class="stat-label">Recipients</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="total-size">0 MB</div>
                    <div class="stat-label">Total Size</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="energy-needed">0</div>
                    <div class="stat-label">Energy Required</div>
                </div>
            </div>
        </div>
        
        <div class="main-grid">
            <!-- Documents Panel -->
            <div class="panel">
                <h2>üìÑ Legal Documents (Shared)</h2>
                <p style="opacity: 0.8; margin-bottom: 15px;">
                    Upload the documents that will be sent to all recipients
                </p>
                
                <div class="document-item">
                    <label>üìã Document 1: Complaint/Petition</label>
                    <input type="file" id="doc1" accept=".pdf,.doc,.docx,image/*" onchange="handleDocumentUpload(1)">
                    <div id="doc1-info" class="file-preview"></div>
                </div>
                
                <div class="document-item">
                    <label>üìã Document 2: Summons/Notice</label>
                    <input type="file" id="doc2" accept=".pdf,.doc,.docx,image/*" onchange="handleDocumentUpload(2)">
                    <div id="doc2-info" class="file-preview"></div>
                </div>
                
                <div class="document-item">
                    <label>üìã Document 3: Supporting Documents</label>
                    <input type="file" id="doc3" accept=".pdf,.doc,.docx,image/*" onchange="handleDocumentUpload(3)">
                    <div id="doc3-info" class="file-preview"></div>
                </div>
            </div>
            
            <!-- Recipients Panel -->
            <div class="panel">
                <h2>üë• Recipients</h2>
                <p style="opacity: 0.8; margin-bottom: 15px;">
                    Add the wallet addresses who will receive these documents
                </p>
                
                <button class="add-btn" onclick="addRecipient()">‚ûï Add Recipient</button>
                
                <div id="recipients-list">
                    <!-- Recipients will be added here -->
                </div>
            </div>
        </div>
        
        <!-- Test Scenarios -->
        <div class="panel">
            <h2>üéØ Quick Test Scenarios</h2>
            <div class="scenario-buttons">
                <div class="scenario-btn" onclick="loadScenario('typical')">
                    <strong>Typical Lawsuit</strong><br>
                    <small>3 docs (500KB each) ‚Üí 4 recipients</small>
                </div>
                <div class="scenario-btn" onclick="loadScenario('large')">
                    <strong>Complex Case</strong><br>
                    <small>3 docs (2MB each) ‚Üí 6 recipients</small>
                </div>
                <div class="scenario-btn" onclick="loadScenario('small')">
                    <strong>Simple Notice</strong><br>
                    <small>1 doc (100KB) ‚Üí 2 recipients</small>
                </div>
                <div class="scenario-btn" onclick="loadScenario('massive')">
                    <strong>Class Action</strong><br>
                    <small>3 docs (1MB each) ‚Üí 10 recipients</small>
                </div>
            </div>
        </div>
        
        <!-- Cost Analysis -->
        <div class="panel">
            <h2>üí∞ Cost Analysis</h2>
            
            <div class="cost-breakdown">
                <div class="cost-row">
                    <span>Base Contract Fee</span>
                    <span id="base-fee">0 TRX</span>
                </div>
                <div class="cost-row">
                    <span>Per Recipient Fee (5 TRX each)</span>
                    <span id="recipient-fee">0 TRX</span>
                </div>
                <div class="cost-row">
                    <span>Document Storage Gas</span>
                    <span id="storage-gas">0 energy</span>
                </div>
                <div class="cost-row">
                    <span>If Burning TRX for Energy</span>
                    <span id="burn-cost">0 TRX</span>
                </div>
                <div class="cost-row">
                    <span>If Renting Energy (88 TRX flat)</span>
                    <span id="rental-cost">88 TRX</span>
                </div>
                <div class="cost-row">
                    <strong>TOTAL (with rental)</strong>
                    <strong id="total-rental">0 TRX</strong>
                </div>
                <div class="cost-row">
                    <strong>TOTAL (burning TRX)</strong>
                    <strong id="total-burn">0 TRX</strong>
                </div>
            </div>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Individual Transactions</th>
                        <th>Batch Transaction</th>
                        <th>Savings</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Base Fees</td>
                        <td id="individual-fees">0 TRX</td>
                        <td id="batch-fees">0 TRX</td>
                        <td id="fee-savings" class="highlight">0 TRX</td>
                    </tr>
                    <tr>
                        <td>Energy Used</td>
                        <td id="individual-energy">0</td>
                        <td id="batch-energy">0</td>
                        <td id="energy-savings" class="highlight">0</td>
                    </tr>
                    <tr>
                        <td>Total Cost</td>
                        <td id="individual-total">0 TRX</td>
                        <td id="batch-total">0 TRX</td>
                        <td id="total-savings" class="highlight">0 TRX</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Action Buttons -->
        <div class="panel" style="text-align: center;">
            <button onclick="checkEnergy()">‚ö° Check Current Energy</button>
            <button onclick="calculateDetailed()">üìä Calculate Detailed Costs</button>
            <button onclick="rentEnergy()">üîã Rent Energy (88 TRX)</button>
            <button onclick="simulateTransaction()">üé≠ Simulate Transaction</button>
            <button onclick="executeTransaction()" style="background: linear-gradient(135deg, #f44336, #e91e63);">
                üöÄ Execute Real Transaction
            </button>
        </div>
        
        <!-- Log -->
        <div class="panel">
            <h2>üìú Transaction Log</h2>
            <div class="log" id="log"></div>
        </div>
    </div>

    <script>
        // Global state
        let documents = { 1: null, 2: null, 3: null };
        let documentHashes = { 1: '', 2: '', 3: '' };
        let recipients = [];
        let tronWeb = null;
        let contract = null;
        let currentEnergy = 0;
        
        const CONTRACT_ADDRESS = 'TLhYHQatauDtZ4iNCePU26WbVjsXtMPdoN';
        
        // Logging
        function log(msg, type = 'info') {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            const className = `log-${type}`;
            logDiv.innerHTML += `<div class="${className}">[${time}] ${msg}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        // Initialize
        async function init() {
            log('üöÄ Initializing Multi-Serve System...', 'info');
            
            // Wait for TronWeb
            let attempts = 0;
            while (!window.tronWeb && attempts < 30) {
                await new Promise(r => setTimeout(r, 1000));
                attempts++;
            }
            
            if (!window.tronWeb || !window.tronWeb.ready) {
                log('‚ùå TronWeb not ready', 'fail');
                return;
            }
            
            tronWeb = window.tronWeb;
            log(`‚úÖ Wallet connected: ${tronWeb.defaultAddress.base58}`, 'pass');
            
            // Add default recipients
            for (let i = 0; i < 4; i++) {
                addRecipient();
            }
            
            updateStats();
        }
        
        // Handle document upload
        function handleDocumentUpload(docNum) {
            const fileInput = document.getElementById(`doc${docNum}`);
            const file = fileInput.files[0];
            
            if (file) {
                documents[docNum] = file;
                const sizeMB = (file.size / 1024 / 1024).toFixed(2);
                
                document.getElementById(`doc${docNum}-info`).innerHTML = 
                    `‚úÖ ${file.name} (${sizeMB} MB)`;
                
                // Generate hash
                const reader = new FileReader();
                reader.onload = async (e) => {
                    const arrayBuffer = e.target.result;
                    const hashBuffer = await crypto.subtle.digest('SHA-256', arrayBuffer);
                    const hashArray = Array.from(new Uint8Array(hashBuffer));
                    documentHashes[docNum] = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                    log(`üìÑ Document ${docNum} hash: ${documentHashes[docNum].substring(0, 16)}...`, 'info');
                };
                reader.readAsArrayBuffer(file);
                
                updateStats();
                calculateCosts();
            }
        }
        
        // Add recipient
        function addRecipient() {
            const id = Date.now() + Math.random();
            const div = document.createElement('div');
            div.className = 'recipient-item';
            div.id = `recipient-${id}`;
            
            const addresses = [
                'TFfagVe1aZpSfYaruY6xJfVPYZBuMj57FH',
                'TGdD34RR3rZfUozoQLze9d4tzFbigL4JAY',
                'T9yD14Nj9j7xAB4dbGeiX9h8unkKHxuWwb',
                'TNPeeaaFB7K9cmo4uQpcU32zGK8G1NYqeL'
            ];
            
            div.innerHTML = `
                <input type="text" placeholder="Recipient ${recipients.length + 1} Wallet Address" 
                       id="address-${id}" value="${addresses[recipients.length] || addresses[0]}">
                <button class="remove-btn" onclick="removeRecipient('${id}')">‚ùå</button>
            `;
            
            document.getElementById('recipients-list').appendChild(div);
            recipients.push(id);
            updateStats();
            calculateCosts();
        }
        
        // Remove recipient
        function removeRecipient(id) {
            document.getElementById(`recipient-${id}`).remove();
            recipients = recipients.filter(r => r !== id);
            updateStats();
            calculateCosts();
        }
        
        // Update statistics
        function updateStats() {
            const docCount = Object.values(documents).filter(d => d !== null).length;
            const totalSize = Object.values(documents).reduce((sum, doc) => 
                sum + (doc ? doc.size : 0), 0);
            const totalSizeMB = (totalSize / 1024 / 1024).toFixed(2);
            
            document.getElementById('doc-count').textContent = docCount;
            document.getElementById('recipient-count').textContent = recipients.length;
            document.getElementById('total-size').textContent = `${totalSizeMB} MB`;
            
            // Calculate energy
            const energyNeeded = calculateEnergyNeeded();
            document.getElementById('energy-needed').textContent = energyNeeded.toLocaleString();
        }
        
        // Calculate energy needed
        function calculateEnergyNeeded() {
            const totalDocSize = Object.values(documents).reduce((sum, doc) => 
                sum + (doc ? doc.size : 0), 0);
            
            // Base energy + document storage energy
            const baseEnergy = 400000;
            const storageEnergy = totalDocSize * 3; // 3 energy per byte for storage
            const perRecipientEnergy = 50000; // Additional energy per recipient
            
            // For batch transaction (more efficient)
            const batchEnergy = baseEnergy + storageEnergy + (perRecipientEnergy * recipients.length);
            
            return Math.floor(batchEnergy * 0.8); // Batch discount
        }
        
        // Calculate costs
        function calculateCosts() {
            const recipientCount = recipients.length;
            const docCount = Object.values(documents).filter(d => d !== null).length;
            
            // Base fees
            const baseFee = 5;
            const recipientFee = baseFee * recipientCount;
            
            // Energy calculations
            const batchEnergy = calculateEnergyNeeded();
            const individualEnergy = batchEnergy * 1.5; // Individual transactions use more energy
            
            // Burn cost (if not renting)
            const burnCost = Math.ceil(batchEnergy * 0.00042);
            
            // Update display
            document.getElementById('base-fee').textContent = `${baseFee} TRX`;
            document.getElementById('recipient-fee').textContent = `${recipientFee} TRX`;
            document.getElementById('storage-gas').textContent = `${batchEnergy.toLocaleString()} energy`;
            document.getElementById('burn-cost').textContent = `~${burnCost} TRX`;
            
            // Totals
            const totalWithRental = recipientFee + 88;
            const totalWithBurn = recipientFee + burnCost;
            
            document.getElementById('total-rental').textContent = `${totalWithRental} TRX`;
            document.getElementById('total-burn').textContent = `${totalWithBurn} TRX`;
            
            // Comparison table
            const individualFees = recipientFee * docCount; // Each doc sent separately
            const individualTotal = individualFees + Math.ceil(individualEnergy * 0.00042);
            
            document.getElementById('individual-fees').textContent = `${individualFees} TRX`;
            document.getElementById('batch-fees').textContent = `${recipientFee} TRX`;
            document.getElementById('fee-savings').textContent = `${individualFees - recipientFee} TRX saved`;
            
            document.getElementById('individual-energy').textContent = individualEnergy.toLocaleString();
            document.getElementById('batch-energy').textContent = batchEnergy.toLocaleString();
            document.getElementById('energy-savings').textContent = 
                `${(individualEnergy - batchEnergy).toLocaleString()} saved`;
            
            document.getElementById('individual-total').textContent = `${individualTotal} TRX`;
            document.getElementById('batch-total').textContent = `${totalWithRental} TRX`;
            document.getElementById('total-savings').textContent = 
                `${Math.max(0, individualTotal - totalWithRental)} TRX saved`;
            
            return { recipientFee, batchEnergy, burnCost, totalWithRental, totalWithBurn };
        }
        
        // Load scenario
        function loadScenario(type) {
            // Clear current documents
            documents = { 1: null, 2: null, 3: null };
            documentHashes = { 1: '', 2: '', 3: '' };
            
            // Clear recipients
            document.getElementById('recipients-list').innerHTML = '';
            recipients = [];
            
            const scenarios = {
                typical: { docs: 3, docSize: 500 * 1024, recipients: 4 },
                large: { docs: 3, docSize: 2 * 1024 * 1024, recipients: 6 },
                small: { docs: 1, docSize: 100 * 1024, recipients: 2 },
                massive: { docs: 3, docSize: 1024 * 1024, recipients: 10 }
            };
            
            const scenario = scenarios[type];
            
            // Simulate documents
            for (let i = 1; i <= scenario.docs; i++) {
                documents[i] = { size: scenario.docSize, name: `Document_${i}.pdf` };
                documentHashes[i] = `HASH_${type}_${i}`;
                const sizeMB = (scenario.docSize / 1024 / 1024).toFixed(2);
                document.getElementById(`doc${i}-info`).innerHTML = 
                    `‚úÖ Test Document ${i} (${sizeMB} MB)`;
            }
            
            // Add recipients
            for (let i = 0; i < scenario.recipients; i++) {
                addRecipient();
            }
            
            log(`üìã Loaded ${type} scenario: ${scenario.docs} docs ‚Üí ${scenario.recipients} recipients`, 'info');
            updateStats();
            calculateCosts();
        }
        
        // Check energy
        async function checkEnergy() {
            if (!tronWeb) {
                log('‚ùå TronWeb not connected', 'fail');
                return;
            }
            
            try {
                const account = await tronWeb.trx.getAccount(tronWeb.defaultAddress.base58);
                currentEnergy = account.energy || 0;
                log(`‚ö° Current energy: ${currentEnergy.toLocaleString()}`, 'info');
                
                const needed = calculateEnergyNeeded();
                if (currentEnergy < needed) {
                    log(`‚ö†Ô∏è Insufficient energy! Have ${currentEnergy}, need ${needed}`, 'warn');
                    log(`üí° Consider renting energy to save TRX`, 'info');
                } else {
                    log(`‚úÖ Sufficient energy for transaction`, 'pass');
                }
                
                return currentEnergy;
            } catch (error) {
                log(`‚ùå Energy check failed: ${error.message}`, 'fail');
                return 0;
            }
        }
        
        // Calculate detailed costs
        function calculateDetailed() {
            const costs = calculateCosts();
            
            log('üìä === DETAILED COST ANALYSIS ===', 'info');
            log(`Documents: ${Object.values(documents).filter(d => d).length}`, 'info');
            log(`Recipients: ${recipients.length}`, 'info');
            log(`Total document size: ${document.getElementById('total-size').textContent}`, 'info');
            log('', 'info');
            log('üí∞ COSTS:', 'info');
            log(`  Base fee: ${costs.recipientFee} TRX`, 'info');
            log(`  Energy needed: ${costs.batchEnergy.toLocaleString()}`, 'info');
            log(`  Energy burn cost: ~${costs.burnCost} TRX`, 'warn');
            log(`  Energy rental cost: 88 TRX (flat rate)`, 'info');
            log('', 'info');
            log('üìà TOTALS:', 'info');
            log(`  With rental: ${costs.totalWithRental} TRX`, 'pass');
            log(`  With burn: ${costs.totalWithBurn} TRX`, 'warn');
            log(`  Savings with rental: ${costs.totalWithBurn - costs.totalWithRental} TRX`, 'pass');
            
            if (costs.batchEnergy > 1000000) {
                log('üí° RECOMMENDATION: Rent energy for this transaction!', 'pass');
            }
        }
        
        // Simulate transaction
        async function simulateTransaction() {
            log('üé≠ Starting transaction simulation...', 'info');
            
            const docCount = Object.values(documents).filter(d => d).length;
            if (docCount === 0) {
                log('‚ùå No documents uploaded', 'fail');
                return;
            }
            
            if (recipients.length === 0) {
                log('‚ùå No recipients added', 'fail');
                return;
            }
            
            log(`üì¶ Preparing batch: ${docCount} docs ‚Üí ${recipients.length} recipients`, 'info');
            
            // Combine document hashes
            const combinedHash = Object.values(documentHashes).filter(h => h).join('_');
            
            // Simulate batch creation
            const batch = [];
            for (const recipientId of recipients) {
                const address = document.getElementById(`address-${recipientId}`).value;
                batch.push({
                    recipient: address,
                    documentHash: combinedHash,
                    // ... other fields
                });
            }
            
            log(`‚úÖ Batch prepared with ${batch.length} entries`, 'pass');
            
            const costs = calculateCosts();
            log(`üí∞ Transaction cost: ${costs.totalWithRental} TRX (with rental)`, 'info');
            log(`‚ö° Energy required: ${costs.batchEnergy.toLocaleString()}`, 'info');
            
            // Simulate processing
            log('Processing...', 'info');
            await new Promise(r => setTimeout(r, 2000));
            
            log('‚úÖ Simulation complete!', 'pass');
            log(`Would create ${recipients.length} NFTs with shared documents`, 'pass');
            log(`Estimated transaction ID: 0x${Math.random().toString(36).substring(2)}`, 'info');
        }
        
        // Execute transaction (placeholder)
        async function executeTransaction() {
            if (!confirm('This will execute a real transaction. Continue?')) {
                return;
            }
            
            log('üöÄ Executing real transaction...', 'warn');
            log('‚ùå Real execution not implemented in test mode', 'fail');
        }
        
        // Rent energy (placeholder)
        async function rentEnergy() {
            log('üîã Renting energy from JustLend...', 'info');
            log('‚ùå Energy rental not available in test mode', 'fail');
            log('üí° In production, this would rent ~3.2M energy for 88 TRX', 'info');
        }
        
        // Initialize on load
        window.addEventListener('load', init);
    </script>
</body>
</html>